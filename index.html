<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MI IA PRO</title>
<style>
    body { background: #050505; color: white; font-family: sans-serif; margin: 0; display: flex; flex-direction: column; height: 100vh; }
    .header { background: #667eea; padding: 15px; text-align: center; font-weight: bold; }
    #chat { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px; }
    .msg { padding: 10px 15px; border-radius: 15px; max-width: 80%; word-wrap: break-word; }
    .user { align-self: flex-end; background: #667eea; }
    .bot { align-self: flex-start; background: #222; border: 1px solid #444; }
    .input-box { padding: 15px; background: #111; display: flex; gap: 10px; }
    input { flex: 1; padding: 12px; border-radius: 10px; border: none; background: #222; color: white; outline: none; font-size: 16px; }
    button { background: #667eea; border: none; color: white; padding: 10px 15px; border-radius: 10px; cursor: pointer; }
</style>
</head>
<body>
<div class="header">MI ASISTENTE IA</div>
<div id="chat"></div>
<div class="input-box">
  <input type="text" id="userInput" placeholder="Escribe un mensaje...">
  <button onclick="sendMsg()">➤</button>
</div>
<script>
async function sendMsg() {
  const input = document.getElementById('userInput');
  const text = input.value.trim();
  if (!text) return;
  addMsg('user', text);
  input.value = '';
  try {
    const response = await fetch('/api/chat', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ message: text })
    });
    const data = await response.json();
    if (data.reply) {
      addMsg('bot', data.reply);
    } else {
      addMsg('bot', "❌ Error: " + (data.error || "Error desconocido"));
    }
  } catch (err) {
    addMsg('bot', "❌ Error de conexión con el servidor");
  }
}
function addMsg(role, text) {
  const div = document.createElement('div');
  div.className = 'msg ' + role;
  div.innerText = text;
  const chat = document.getElementById('chat');
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}
</script>
</body>
</html>
